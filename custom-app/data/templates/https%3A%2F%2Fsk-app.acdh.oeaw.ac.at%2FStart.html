<style>
	table.table {
	  min-width: 100%;
	}

	tr.standard-row {
	  border: none!important;
	}

	.table > tbody + tbody {
	  border: none!important;
	}

	.table > tbody + tbody > tr {
	  border: none!important;
	}


	.res-label {
	  float: left;
	}

	.res-comment {
	  clear: left;
	  margin-top: 10px;
	  margin-bottom: 10px;
	}

	.res-img-thumbnail {
	  display: inline;
	  float: left;
	  max-width: 50px;
	  max-height: 50px;
	  margin-right: 10px;
	  margin-bottom: 5px;
	}

	input#semantic-search-text-input {
	  margin-top: 10vh!important;
	  width: 50vw;
	  margin: 0 auto;
	  text-align: center;
	}
  </style>

<ol class="page-breadcrumb">
<li>
  <mp-link title="Home" url="/">Home</mp-link>
</li>
<li class="active">
  <mp-label iri="[[this]]"></mp-label>
</li>
</ol>

<main class="page">
<div class="page__hero">
  <!-- <img alt="" src="/assets/images/hero.png" > -->
  <h1>Semantic Kraus - Exploration platform</h1>
</div>

  <section class="page-section">
	  <h2 class="page-section__title">Sample Entities:</h2>
	  <div class="home-page__grid">
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/pmb11988">
				  Sample: Karl Kraus (LK)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/pmb39331">
				  Sample: Oscar Pollak (LK)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/pmb61389">
				  Sample: Newspaper Article (LK)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/D_000068-062-000">
				  Sample: Court File (LK)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link
				  uri="https://sk.acdh.oeaw.ac.at/D_000068-062-000/passage/771"
			  >
				  Sample: Text Passage – Intertextual Relation  (LK)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link
				  uri="https://sk.acdh.oeaw.ac.at/D_000068-062-000/passage/854"
			  >
				  Sample: Text Passage – Person Mention  (LK)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/DWbibl00000">
				  Sample: Dritte Walpurgisnacht (DW)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/DWpers0125">
				  Sample: Alfred Kerr (DW)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/DWbibl00000/passage/2092">
				  Sample: Text Passage – Person Mention (DW)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/p_46460">
				  Sample: Imre Békessy (FA)
			  </semantic-link>
		  </div>
		  <div class="home-page__grid-item">
			  <semantic-link uri="https://sk.acdh.oeaw.ac.at/text10013">
				  Sample: Das technoromantische Abenteuer (FA)
			  </semantic-link>
		  </div>
	  </div>
  </section>

<!--
  <h2>
	  <mp-link url="sk:model">
		  Model
	  </mp-link>
  </h2>
  <h2>
	  <mp-link url="/sparql">
		  SPARQL Interface
	  </mp-link>
  </h2>
  <h2>
	  <semantic-link iri="app:Overview">
		  Data Overview
	  </semantic-link>
  </h2>
  -->

  <section class="page-section">
	  <h2 class="page-section__title">
		  <semantic-link iri="rsp:Search"> Under Construction: Search </semantic-link>
	  </h2>
  <semantic-search limit=[[#if searchLimit]][[searchLimit]][[else]]10[[/if]]>
	[[!-- heuristics to check whether we have a blazegraph instance and can apply bds search --]]
	[[#if (ask "ASK {  <http://www.bigdata.com/queryHints#Query> <http://www.bigdata.com/queryHints#optimizer> 'None' . ?x ?y ?z . }") ]]
	  <semantic-search-query-keyword 
		[[#if searchPlaceholder]]placeholder='[[searchPlaceholder]]'[[/if]]                                 
		domain='<http://www.w3.org/2000/01/rdf-schema#Resource>'
		query='
		  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
					  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
					  PREFIX bds: <http://www.bigdata.com/rdf/search#>
					  PREFIX frbr: <https://cidoc-crm.org/frbroo/sites/default/files/FRBR2.4-draft.rdfs#>
					  PREFIX intro: <https://w3id.org/lso/intro/beta202304#>

		  SELECT ?subject WHERE {
			[[#if searchPattern]]
			  [[searchPattern]]
			[[else]]                      
			  {?subject rdfs:label|skos:prefLabel ?label .}
			  UNION
			  {?subject crm:P1_is_identified_by ?appellation.
			   ?appellation a crm:E33_E41_Linguistic_Appellation;
							  rdfs:label ?label .}
			  ?subject a ?type .
			  # filter for E21, E33, E35, E41, E42, E52, E73, E90; F22
			  filter (?type in (
				crm:E21_Person,
				crm:E53_Place,
				frbr:F22_Self-Contained_Expression,
				frbr:F24_Publication_Expression,
				crm:E73_Information_Object
			  ))
			  ?label bds:search ?__token__ ;
				bds:minRelevance "0.5" ;
				bds:relevance ?score ;
				bds:matchAllTerms "true" .
			  BIND(STRLEN(?label) as ?length)
			 [[/if]]
		  } ORDER BY DESC(?score) ?length
		'
	  ></semantic-search-query-keyword>
	[[else]]
	  <semantic-search-query-keyword 
		[[#if searchPlaceholder]]placeholder='[[searchPlaceholder]]'[[/if]]                          
		domain='<http://www.w3.org/2000/01/rdf-schema#Resource>'
		escape-lucene-syntax='false'
		query='
		  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
					  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
		  SELECT ?subject WHERE {
			[[#if searchPattern]]
			  [[searchPattern]]
			[[else]]
			  ?subject rdfs:label|skos:prefLabel ?label .                
			  FILTER(REGEX(?label, ?__token__, "i"))
			  BIND(STRLEN(?label) as ?length)
			[[/if]]
		  } ORDER BY DESC(?score) ?length
		'
	  ></semantic-search-query-keyword>
	[[/if]]
<div data-flex-layout="row stretch-stretch">
  <semantic-search-result-holder>
	<div data-flex-self="md-full">
	  <semantic-search-result>
		<semantic-table id='grid-result'
				  query='SELECT DISTINCT ?subject (SAMPLE(?rawDesc) as ?description) WHERE {
								OPTIONAL { ?subject rdfs:comment ?rawDesc . }
						  } GROUP BY ?subject LIMIT [[#if searchLimit]][[searchLimit]][[else]]10[[/if]]'

				  number-of-displayed-rows='10'
				  column-configuration='[
					  {"variableName":"subject", "displayName":"Result", "cellTemplate":"{{> subjectCellTemplate }}"}
				 ]'
				  options='{"showTableHeading": false, "showFilter":false}'
				  no-result-template='<div style="text-align: center;">No results. Please refine your keyword.</div>'>
		  <template id="subjectCellTemplate">
			   <mp-panel>
				<mp-panel-body>
				  <div>
					<div>
					  <mp-resource-thumbnail iri="{{subject.value}}" class="res-img-thumbnail"></mp-resource-thumbnail>
					  <div class="res-label">
						<h4><semantic-link uri="{{subject.value}}"></semantic-link></h4>
					  </div>
					</div>
					
				  </div>
				</mp-panel-body>
				<mp-panel-footer>
				  <div>
					<div><b>URI: </b><i>{{subject.value}}</i></div>
					<div class="res-comment">{{description.value}}</div>
					<div><b>Types: </b><semantic-query style='display:inline;' query='SELECT ?type WHERE { <{{subject.value}}> a ?type}' no-result-template='-'></semantic-query></div>
				  </div>
				</mp-panel-footer>
			  </mp-panel>
		  </template>
				  </semantic-table>          
			  </semantic-search-result>
	</div>
  </semantic-search-result-holder>
</div>
</semantic-search>
  </section>
</main>
